
MODULE channel_id(sensor_output, sensor_input)
DEFINE
    capB := capa;
    rr := 2;
    sr := 2;
VAR
    p_buffer : 0.. capB;
IVAR
    action : {receive, send};
ASSIGN
    init(p_buffer) := 0;
    next(p_buffer) :=
        case
            action = receive & sensor_output.num_p >= rr & p_buffer <= capB - rr : p_buffer + rr;
            action = send & p_buffer >= sr : p_buffer - sr;
            TRUE : p_buffer;
        esac;
    next(sensor_output.num_p) :=
        case
            action = receive & sensor_output.num_p >= rr : sensor_output.num_p - rr;
            TRUE : sensor_output.num_p;
        esac;
    next(sensor_input.num_p) :=
        case
            action = send & p_buffer >= sr &sensor_input.num_p <= 50 - sr : sensor_input.num_p + sr;
            TRUE : sensor_input.num_p;
        esac;

